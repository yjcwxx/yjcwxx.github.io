---
import siteConfig from '../../site.config.mjs';

const title = siteConfig.title;

const base = import.meta.env.BASE_URL;
// Remove trailing slash from base to avoid double slashes
const baseClean = base === '/' ? '' : base;
const menuItems = [
	{ name: '首页', link: '/' },
	{ name: '相册', link: `${baseClean}/collections` },
	{ name: '关于我们', link: `${baseClean}/about` },
];
---

<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link
	href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400..700&display=swap"
	rel="stylesheet"
/>

<nav
	x-data="{ isOpen: false, scrolled: false }"
	@scroll.window="scrolled = window.scrollY > 50"
	class="fixed top-0 left-0 w-full z-50 transition-all duration-300"
	:class="scrolled ? 'py-3 bg-white shadow-sm' : 'py-5 bg-transparent'"
>
	<div class="container mx-auto flex justify-between items-center">
		<a href="/" id="logo" class="text-2xl md:text-4xl font-semibold tracking-tight">
			{title}
		</a>

		<!-- Desktop Menu -->
		<div class="hidden md:flex space-x-8 items-center">
			{
				menuItems.map((item) => (
					<a
						href={item.link}
						class="nav-link relative after:content-[''] after:absolute after:left-0 after:bottom-[-2px] after:h-[2px] after:bg-black after:w-0 hover:after:w-full transition-all"
					>
						{item.name}
					</a>
				))
			}
			<!-- 背景颜色切换按钮 -->
			<button 
				id="bg-toggle"
				class="ml-1 p-2 rounded-full hover:bg-gray-200 transition-colors duration-300"
				title="切换背景颜色"
			>
				<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
					<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"></path>
				</svg>
			</button>
		</div>

		<!-- Mobile Right Side -->
		<div class="flex items-center gap-2 md:hidden">
			<!-- 背景颜色切换按钮 (移动端) -->
			<button 
				id="bg-toggle-mobile"
				class="p-2 rounded-full hover:bg-gray-200 transition-colors duration-300"
				title="切换背景颜色"
			>
				<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
					<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"></path>
				</svg>
			</button>
			
			<!-- Mobile Menu Button -->
			<button @click="isOpen = !isOpen" class="text-gray-800 focus:outline-none">
				<svg x-show="!isOpen" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
					<path
						stroke-linecap="round"
						stroke-linejoin="round"
						stroke-width="2"
						d="M4 6h16M4 12h16M4 18h16"></path>
				</svg>
				<svg x-show="isOpen" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
					<path
						stroke-linecap="round"
						stroke-linejoin="round"
						stroke-width="2"
						d="M6 18L18 6M6 6l12 12"></path>
				</svg>
			</button>
		</div>
	</div>

	<!-- Mobile Menu -->
	<div x-show="isOpen" class="md:hidden absolute top-full left-0 w-full bg-white shadow-md">
		<div class="flex flex-col py-4 px-6 space-y-4">
			{
				menuItems.map((item) => (
					<a href={item.link} class="text-lg" @click="isOpen = false">
						{item.name}
					</a>
				))
			}
		</div>
	</div>
</nav>

<script>
	// 背景颜色切换功能
	function initBackgroundToggle() {
		const bgToggle = document.getElementById('bg-toggle');
		const bgToggleMobile = document.getElementById('bg-toggle-mobile');
		const body = document.body;
		
		// 设置过渡效果
		body.style.transition = 'background-color 0.8s ease';
		
		// 从 localStorage 读取保存的背景颜色偏好
		const savedBgColor = localStorage.getItem('bgColor');
		if (savedBgColor === 'pink') {
			body.style.backgroundColor = '#fff0f5'; // 浅粉色
		}
		
		// 切换背景颜色的函数
		function toggleBackground() {
			const currentBg = body.style.backgroundColor;
			if (currentBg === 'rgb(255, 240, 245)' || currentBg === '#fff0f5') {
				// 切回白色
				body.style.backgroundColor = '#ffffff';
				localStorage.setItem('bgColor', 'white');
			} else {
				// 切换到浅粉色
				body.style.backgroundColor = '#fff0f5';
				localStorage.setItem('bgColor', 'pink');
			}
		}
		
		// 为桌面端按钮添加事件监听
		if (bgToggle) {
			bgToggle.addEventListener('click', toggleBackground);
		}
		
		// 为移动端按钮添加事件监听
		if (bgToggleMobile) {
			bgToggleMobile.addEventListener('click', toggleBackground);
		}
	}
	
	// 页面加载完成后初始化
	if (document.readyState === 'loading') {
		document.addEventListener('DOMContentLoaded', initBackgroundToggle);
	} else {
		initBackgroundToggle();
	}
</script>
